# 基本アーキテクチャ実装

## 実装内容

マイルストーンM2「基本アーキテクチャ実装」の指示に従い、以下の機能を実装しました：

1. **SQLiteデータベースの統合**
   - `better-sqlite3`パッケージをインストール
   - シングルトンパターンを使用したデータベース接続管理クラス（`DatabaseManager`）を作成
   - ノート操作のためのリポジトリクラス（`NoteRepository`）を実装

2. **基本的なファイル操作機能**
   - ファイル操作ユーティリティクラス（`FileUtils`）を作成
   - ノートのインポート/エクスポート機能を提供する`ImportExportService`を実装

3. **アプリケーションの状態管理の拡張**
   - Zustandを使用したノート管理ストア（`noteStore`）を実装
   - アプリケーション設定を管理するストア（`settingsStore`）を実装
   - ローカルストレージを使用した設定の永続化

4. **コンポーネント間の通信システム**
   - Electron IPCを使用したメインプロセスとレンダラープロセス間の通信を実装
   - ノート操作のためのIPCハンドラーを作成
   - レンダラープロセス側でIPCを使用するためのサービスを実装

5. **基本的なUIフレームワークの統合**
   - Material UIのテーマを設定
   - ライト/ダークモードの切り替え機能を実装
   - レイアウトコンポーネントを更新

## 実装の詳細

### データベース設計

データベースには以下のテーブルを作成しました：

- `notes`: ノートの基本情報（ID、タイトル、内容、作成日時、更新日時）
- `tags`: タグ情報（ID、名前）
- `note_tags`: ノートとタグの関連付け（ノートID、タグID）

これにより、ノートとタグの多対多の関係を表現しています。

### ファイル操作

ファイル操作は非同期で行い、UIをブロックしないようにしています。また、ディレクトリが存在しない場合は自動的に作成するようにしています。

### 状態管理

Zustandを使用して、以下の状態を管理しています：

- ノート一覧
- 選択中のノート
- ローディング状態
- エラー情報
- アプリケーション設定（テーマ、フォントサイズ、サイドバー幅、自動保存設定）

### プロセス間通信

Electron IPCを使用して、以下の操作を実装しました：

- ノートの取得（全件、ID指定）
- ノートの作成、更新、削除
- ノートのインポート/エクスポート
- ノートのMarkdownエクスポート

### UIフレームワーク

Material UIを使用して、以下のコンポーネントを実装/更新しました：

- テーマプロバイダー
- レイアウト
- ヘッダー
- サイドバー

## 次のステップ

次のマイルストーンM3「エディタ機能実装」では、以下の機能を実装する予定です：

1. リッチテキストエディタの統合
2. マークダウンサポート
3. シンタックスハイライト
4. 画像の挿入と管理
5. 自動保存機能

詳細な指示は `instructions/2025/03/003_editor-implementation.md` を参照してください。
